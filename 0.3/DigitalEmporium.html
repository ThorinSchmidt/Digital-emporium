<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="./DigitalEmporium.css">
		<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js">
		</script>
	</head>
	
	<body>
		<div class="header">
			<div id="left">
				<h3>The</h3>
				<h1>Digital Emporium</h1>
			</div>
			<div id="middle">
				<img src="./images/dragon.png" id="dragon">
				
			</div>
			<div id="right">
				<img src="./images/emporium.png" id="emporium">
			</div>
		</div>
		
		<div class="storefront c">
			<div class="instructions">
				<p>The Digital Emporium is intended as a tool to supplement the Very 
					Well Done supplement "Equipment Emporium" by Joe Ludlum, R.Kevin
					Smoot and Alan Vetter.</p>

				<input type="checkbox" class="chkbox" id="core" name="core" onclick="core_only()">
				<label class="chkbox" for="core"> Use only Core Rules </label><br>
			</div>

			<div class="inventory">
				<h2>Items for Sale</h2>
				
				<p>Select an item below and click "Add Selected" once for each item you
					wish to "purchase." It will appear in the list on the right.</p>
					
				<table class="inventory_table" id="inventory">
					<thead>
						<tr>
							<th class="first"> Item Name </th>
							<th class="second"> Cost (GP) </th>
							<th class="third"> Weight </th>
						</tr>
					</thead>
					<tbody>
						<tr class="category">
							<td class="first"> MELEE WEAPONS </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
						</tr>
						<tr class="subcategory">
							<td class="first"> Axes </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Hand Axe </td>
							<td class="second"> 4 </td>
							<td class="third"> 5 </td>
						</tr>
						<tr>
							<td class="first"> Battle Axe </td>
							<td class="second"> 7 </td>
							<td class="third"> 7 </td>
						</tr>
						<tr>
							<td class="first"> Great Axe </td>
							<td class="second"> 14 </td>
							<td class="third"> 15 </td>
						</tr>
						<tr>
							<td class="first"> Pickaxe (Military Pick) </td>
							<td class="second"> 6 </td>
							<td class="third"> 4 </td>
						</tr>
						<tr>
							<td class="first"> Mattock (Footman's Pick) </td>
							<td class="second"> 8 </td>
							<td class="third"> 6 </td>
						</tr>
						<tr class="subcategory">
							<td class="first"> Daggers </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Standard Dagger </td>
							<td class="second"> 2 </td>
							<td class="third"> 1 </td>
						</tr>
						<tr>
							<td class="first"> Defending Dagger </td>
							<td class="second"> 7 </td>
							<td class="third"> 2 </td>
						</tr>
						<tr>
							<td class="first"> Silver Dagger </td>
							<td class="second"> 25 </td>
							<td class="third"> 1 </td>
						</tr>
						<tr class="subcategory">
							<td class="first"> Swords </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Shortsword / Cutlass </td>
							<td class="second"> 6 </td>
							<td class="third"> 3 </td>
						</tr>
						<tr>
							<td class="first"> Longsword / Scimitar </td>
							<td class="second"> 10 </td>
							<td class="third"> 4 </td>
						</tr>
						<tr>
							<td class="first"> Two-Handed Sword </td>
							<td class="second"> 18 </td>
							<td class="third"> 10 </td>
						</tr>
						<tr class="subcategory">
							<td class="first"> Hammers and Maces </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Warhammer </td>
							<td class="second"> 4 </td>
							<td class="third"> 6 </td>
						</tr>
<!--					<tr>
							<td class="first">  </td>
							<td class="second">  </td>
							<td class="third">  </td>
						</tr>
-->					</tbody>
				</table>
			</div>
			
			<div class="description">
				<h2>Detailed descrption here (someday)</h2>
			</div>
			
			<div class="buttons">
				<button id="add" onclick="add()">Add Selected</button>
				<br>
				<button id="remove" onclick="remove()">Remove Selected</button>
				<br>
				<button id="clear" onclick="clear_selections()">
					Clear All Selections</button>
			</div>
			
			<div class="purchases">
				<h2>Shopping Basket (or Box, going by the book cover)</h2>
				
				<p>To remove an item, select it in the table below, and click "Remove 
					Selected". To start over, click "Clear All Selections." Cumulative totals
					will appear be;ow.</p>
					
				<table class="selection_table" id="selection">
					<thead>
						<tr>
							<th class="first"> Item Name </th>
							<th class="second"> Quantity </th>
							<th class="third"> Cost (GP) </th>
							<th class="fourth"> Weight </th>
						</tr>
					</thead>
					<tbody>
						<tr class="category">
							<td class="first"> MELEE WEAPONS </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
							<td class="fourth"> &nbsp; </td>
						</tr>
						<tr class="subcategory">
							<td class="first"> Axes </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
							<td class="fourth"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Hand Axe </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Battle Axe </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Great Axe </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Pickaxe (Military Pick) </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Mattock (Footman's Pick) </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr class="subcategory">
							<td class="first"> Daggers </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
							<td class="fourth"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Standard Dagger </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Defending Dagger </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Silver Dagger </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr class="subcategory">
							<td class="first"> Swords </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
							<td class="fourth"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Shortsword / Cutlass </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Longsword / Scimitar </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
						<tr>
							<td class="first"> Two-Handed Sword </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>							
						</tr>
						<tr class="subcategory">
							<td class="first"> Hammers and Maces </td>
							<td class="second"> &nbsp; </td>
							<td class="third"> &nbsp; </td>
							<td class="fourth"> &nbsp; </td>
						</tr>
						<tr>
							<td class="first"> Warhammer </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
<!--					<tr>
							<td class="first">  </td>
							<td class="second"> 0 </td>
							<td class="third"> 0 </td>
							<td class="fourth"> 0 </td>
						</tr>
-->					</tbody>
				</table>
				
			</div>
			
			<div class="summary">
				<h2>Your Grand Totals: <span id="tot_gold"> 0.0 </span> gp,
					<span id="tot_wt"> 0.0 </span> lbs.</h2>
			</div>
		</div>
		
		<div class="footer">
			<h1>FOOTER</h1>
		</div>
	</body>		

	<script>
		//globals
		var summary_cost = 0;
		var summary_weight = 0;
		var count = 0;
	
		//initialize the selection table numerics to 0, all rows hidden
		$(document).ready(clear_selections());
		
		function core_only() {
			// Get the checkbox
			var check_box = document.getElementById("core");
						
			if (check_box.checked == true){
				if (count == 0){
					alert("This checkbox does nothing!");
					$("#core").prop( "checked", false );
				} else if (count == 1) {
					alert("Nope, still does nothing!");
					$("#core").prop( "checked", false );
				} else if (count == 2) {
					alert("This. Checkbox. Does. Nothing!");
					$("#core").prop( "checked", false );
				} else if (count == 3) {
					alert("It's coming in the next Sprint, OK?\n YEESH!");
					$("#core").prop( "checked", false );
				} else if (count == 4) {
					alert("You think you're really funny, dont you?");
					$("#core").prop( "checked", false );
				} else {
					alert("That'S IT! \n I've had enough!");
					$(".chkbox").css("display", "none");
				}
				count++;
			}
		}
		
		//set all rows in select_table to class .hidden set numerics t0 0
		function clear_selections() {
			$("#selection tbody tr").addClass('hidden');
			$("#selection tbody tr").find("td:nth-child(2)").html('0');
			$("#selection tbody tr").find("td:nth-child(3)").html('0');
			$("#selection tbody tr").find("td:last").html('0');
			$("#inventory tr").removeClass("selected");
			$("#selection tr").removeClass("selected");
			$("#tot_gold").html("0.0");
			$("#tot_wt").html("0.0");
			$("#core").prop( "checked", false );
		}
	
		//"add" item to selections table
		function add() {
			let inv_row = $("#inventory .selected");
			
			if(inv_row) {
				let item_name = $(inv_row).find('td:first').html();
				let item_cost = parseFloat($(inv_row).find('td:nth-child(2)').html());
				let item_weight = parseFloat($(inv_row).find('td:last').html());
			

				// search the other table for the matching row and display it
				let sel_row = $("#selection tr:contains('" + item_name + "')");
				$(sel_row).removeClass('hidden');
				
				// increment the numerics
				let item_qty = parseFloat($(sel_row).find('td:nth-child(2)')
										  .html()) + 1;
				let item_tot_cost = parseFloat($(sel_row).find('td:nth-child(3)')
											   .html()) + item_cost;
				let item_tot_wt = parseFloat($(sel_row).find('td:last')
											   .html()) + item_weight;
				
				// increment the summary values
				summary_cost = summary_cost + item_cost;
				summary_weight = summary_weight + item_weight;
				
				//display changes to screen
				//$('#'+table).find('tr#'+rowId).find('td:eq(colNum)').html(newValue);
				$(sel_row).find('td:nth-child(2)').html(item_qty);
				$(sel_row).find('td:nth-child(3)').html(item_tot_cost);
				$(sel_row).find('td:last').html(item_tot_wt);
				$("#tot_gold").html(summary_cost);
				$("#tot_wt").html(summary_weight);
			}
		}
	
		//"remove" item from selections table
		function remove() {
			let sel_row = $("#selection .selected");

			if(sel_row) {
				//obtain name and numeric data from selection table
				let item_name = $(sel_row).find('td:first').html();
				let item_qty = parseFloat($(sel_row).find('td:nth-child(2)').html());
				let item_tot_cost = parseFloat($(sel_row).find('td:nth-child(3)').html());
				let item_tot_wt = parseFloat($(sel_row).find('td:last').html());
				const arr = [item_name, item_qty, item_tot_cost, item_tot_wt];
				
				// search the other table for the matching row and assign numerics
				let inv_row = $("#inventory tr:contains('" + item_name + "')");
				let item_cost = parseFloat($(inv_row).find('td:nth-child(2)').html());
				let item_weight = parseFloat($(inv_row).find('td:last').html());

				// decrement the numeric values.
				item_qty = parseFloat($(sel_row).find('td:nth-child(2)')
									  .html()) - 1;
				item_tot_cost = parseFloat($(sel_row).find('td:nth-child(3)')
										   .html()) - item_cost;
				item_tot_wt = parseFloat($(sel_row).find('td:last')
										 .html()) - item_weight;
				
				//if the quantity is zero, hide the row again.
				if (item_qty == 0){
					$(sel_row).addClass('hidden');
				}
				
				// decrement the summary values
				summary_cost = summary_cost - item_cost;
				summary_weight = summary_weight - item_weight;
				
				//display changes to screen
				$(sel_row).find('td:nth-child(2)').html(item_qty);
				$(sel_row).find('td:nth-child(3)').html(item_tot_cost);
				$(sel_row).find('td:last').html(item_tot_wt);
				$("#tot_gold").html(summary_cost);
				$("#tot_wt").html(summary_weight);

			}
		}
	
		// Highlight selected row in inventory table
		$("#inventory tr").click(function(){
			//bail if the clicked row is a "category" row
			let test = $(this).find('td:nth-child(2)').html();
			if (isNaN(parseFloat(test))){
				return;
			}
			$(this).addClass('selected').siblings().removeClass('selected');
			$("#selection .selected").removeClass('selected');
    	});
		
		// Highlight selected row in selections table
		$("#selection tr").click(function(){
			//bail if the clicked row is a "category" row - shouldn't be possible
			let test = $(this).find('td:nth-child(2)').html();
			if (isNaN(parseFloat(test))){
				return;
			}
			$(this).addClass('selected').siblings().removeClass('selected');
			$("#inventory .selected").removeClass('selected');
    	});
	</script>

</html>
